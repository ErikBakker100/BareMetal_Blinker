# Erik Bakker, 5-2025
# The FT232H is a single channel USB 2.0 Hi-Speed (480Mb/s) to UART/FIFO IC
# Setup driver type
adapter driver ftdi
# PID for FT232H
ftdi vid_pid 0x0403 0x6014
# FT232H has only one channel
ftdi channel 0
transport select jtag
ftdi layout_signal nTRST -data 0x0010
ftdi layout_signal nSRST -data 0x0020
ftdi layout_signal RTCK -data 0x0040
# ftdi_layout_init <output_value> <direction>
# output_value: 8-bit value (bits 0â€“7) that sets the default output states of each FTDI pin.
# direction: 8-bit value defining which pins are outputs (1) and which are inputs (0).
# Value (0x38 = 0011 1000). This sets:
	#      (bit 0) = LOW  (0)
	#      (bit 1) = LOW  (0)
	#      (bit 2) = LOW  (0)
    # TMS  (bit 3) = HIGH (1)
    # TRST (bit 4) = HIGH (1)
    # SRST (bit 5) = HIGH (1)
    # RTCK (bit 7) = LOW  (0)
	
# Direction (0x3b = 0011 1011). This sets:
    # TCK  (bit 0) = OUTPUT (1)
    # TDI  (bit 1) = OUTPUT (1)
    # TDO  (bit 2) = INPUT  (0)
    # TMS  (bit 3) = OUTPUT (1)
    # TRST (bit 4) = OUTPUT (1)
    # SRST (bit 5) = OUTPUT (1)
    #      (bit 6) = not used
    # RTCK (bit 7) = INPUT  (0)	
	
ftdi layout_init 0x0038 0x003b
# Set sampling to allow higher clock speed
ftdi tdo_sample_edge falling
#reset_config separate trst_and_srst trst_push_pull srst_push_pull
reset_config trst_only trst_push_pull
#reset_config none
#adapter srst pulse_width 50
#adapter srst delay 5000
jtag_ntrst_assert_width 50
jtag_ntrst_delay 50

# List of connections (default physical pin numbers for FT232H in 48-pin LQFP package):
#	Bit	FT232H ADx	JTAG	FT232H Pinnr   Raspberry GPIO   Header pin nr   Description             Direction (seen from Raspberry)
#	0	ADBUS0		TCK          13          25 (ALT4)              22       ARM JTAG clock              out     1
#	1	ADBUS1		TDI          14          26 (ALT4)              37       ARM JTAG data               out     1
#	2	ADBUS2		TDO          15          24 (ALT4)              18       ARM JTAG data               in      0
#	3	ADBUS3		TMS          16          27 (ALT4)              13       ARM JTAG mode               out     1
#	4	ADBUS4		TRST         17          22 (ALT4)              15       ARM JTAG TAP reset          out     1
#	5	ADBUS5		SRST         18          RUN Pin (not on P1)			 ARM JTAG CPU reset			 out	 1
#	6	ADBUS6			         19 
#	7	ADBUS7					 20          23 (ALT4)              16       ARM JTAG return clock       in      0   pull up, adaptive clocking
#	8	ACBUS0					 21
#	9	ACBUS1					 25
#	10	ACBUS2					 26
#	11	ACBUS3					 27
#	12	ACBUS4					 28
#	13	ACBUS5					 29
#	14	ACBUS6					 30
#	15	ACBUS7					 31
#	16	ACBUS8					 32
#	17	ACBUS9					 33
